# – ELK knowledge

In this room, we get to understand how SIEM works and get comfortable creating simple and advanced search queries to look for specific answers from the ingested logs.
---

Link: https://tryhackme.com/room/itsybitsy

## 1. Executive Summary
Our task in this room will be to examine the network connection logs of this user, find the link and the content of the file, and answer the questions.

## Scenario
During normal SOC monitoring, Analyst John observed an alert on an IDS solution indicating a potential C2 communication from a user Browne from the HR department. A suspicious file was accessed containing a malicious pattern THM:{ ________ }. A week-long HTTP connection logs have been pulled to investigate. Due to limited resources, only the connection logs could be pulled out and are ingested into the connection_logs index in Kibana

---

## Questions 


# 1. How many events were returned for the month of March 2022?


---

## 3. Investigation & Analysis

### 3.1 Initial Alert Review
The alert details were reviewed to understand the scope of the potential threat.

- Suspicious file detected on the endpoint
- Alert severity indicated elevated risk
- Required further validation to confirm malicious activity

![Initial malware alert details](images/alert-details.png)

---

### 3.2 File Analysis
The suspicious file was analyzed to determine its reputation and potential impact.

- **File Name:** <File Name>
- **File Hash:** <MD5 / SHA256>

Threat intelligence sources were used to validate the file hash.

![Threat intelligence result for suspicious file](images/file-hash-analysis.png)

---

### 3.3 Sandbox / Behavioral Analysis
Dynamic analysis was performed to observe the file’s behavior in a controlled environment.

- Observed file execution behavior
- Network activity generated by the file
- Indicators consistent with malware behavior

![Sandbox behavior analysis](images/sandbox-analysis.png)

---

### 3.4 Network Activity Analysis
Outbound network connections originating from the affected host were reviewed.

- Suspicious connections to external IP addresses
- Traffic patterns inconsistent with normal user behavior
- Possible command-and-control (C2) communication

![Suspicious outbound network traffic](images/network-traffic.png)

---

## 4. Indicators of Compromise (IOCs)

| Type | Value | Description |
|------|------|------------|
| File Hash | <Hash Value> | Malicious file |
| External IP | <IP Address> | Suspected C2 server |
| Hostname | <Hostname> | Affected endpoint |

---

## 5. Verdict
Based on file analysis, sandbox behavior, and network activity,
the alert was classified as a:

- **Verdict:** <True Positive / False Positive>

The evidence supported this classification with high confidence.

---

## 6. Containment & Response
The following actions were recommended or performed:

- Isolate the affected endpoint
- Block malicious IPs or domains
- Remove or quarantine the malicious file
- Perform a full endpoint scan

---

## 7. Analyst Reflection
This case reinforced understanding of malware investigation workflows,
including alert validation, file reputation analysis, and identifying
malicious network behavior in a SOC environment.
